<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novi Sad Transit - Real-time Public Transport</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <link rel="stylesheet" href="static/css/style.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="app-bar">
            <div class="app-bar-title">
                <span class="material-icons">directions_bus</span>
                <h1>Novi Sad Transit</h1>
            </div>
            <p class="subtitle">Real-time public transport information for Novi Sad</p>
        </header>

        <main>
            <div class="mode-selector">
                <button type="button" id="departures-mode" class="mode-btn active">üöå Departures</button>
                <button type="button" id="navigation-mode" class="mode-btn">üó∫Ô∏è Navigation</button>
            </div>

            <!-- Departures Mode -->
            <form id="searchForm" class="search-form departures-section">
                <div class="form-group">
                    <label for="searchMode">Search Type:</label>
                    <select id="searchMode" name="searchMode">
                        <option value="id">Station ID</option>
                        <option value="name">Station Name</option>
                        <option value="coords">GPS Location</option>
                    </select>
                </div>

                <div class="search-options">
                    <div class="id-search search-option" style="display: none;">
                        <label for="id-input">Station ID:</label>
                        <input type="number" id="id-input" placeholder="Enter station ID">
                    </div>

                    <div class="name-search search-option" style="display: none;">
                        <label for="name-input">Station Name:</label>
                        <select id="name-input" class="select2" style="width: 100%;">
                            <option value="">Select a station...</option>
                        </select>
                    </div>

                    <div class="coords-search search-option" style="display: none;">
                        <button type="button" id="gps-search" class="btn btn-secondary">
                            üìç Find Nearest Stations
                        </button>
                        <div class="distance-control">
                            <label id="distance-label">Max Distance: 350m</label>
                            <input type="range" id="distance-input" min="50" max="1000" value="350" step="50">
                        </div>
                        <select id="coords-input" class="select2" style="width: 100%; display: none;">
                            <option value="">Select a nearby station...</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üöå Get Departures</button>
                    <div class="options">
                        <label>
                            <input type="checkbox" id="auto-refresh" checked>
                            Auto-refresh (10s)
                        </label>
                        <label>
                            <input type="checkbox" id="sort-lines">
                            Sort by line number
                        </label>
                    </div>
                </div>
            </form>

            <!-- Navigation Mode -->
            <form id="navigationForm" class="navigation-form navigation-section" style="display: none;">
                <div class="trip-inputs">
                    <div class="location-input">
                        <label for="from-input">From:</label>
                        <div class="location-field">
                            <input type="text" id="from-input" placeholder="Enter starting location" class="location-text">
                            <button type="button" id="from-gps" class="gps-btn" title="Use current location">üìç</button>
                            <button type="button" id="from-map" class="map-btn" title="Select on map">üó∫Ô∏è</button>
                        </div>
                    </div>

                    <div class="swap-locations">
                        <button type="button" id="swap-btn" class="btn btn-secondary" title="Swap locations">‚áÖ</button>
                    </div>

                    <div class="location-input">
                        <label for="to-input">To:</label>
                        <div class="location-field">
                            <input type="text" id="to-input" placeholder="Enter destination" class="location-text">
                            <button type="button" id="to-gps" class="gps-btn" title="Use current location">üìç</button>
                            <button type="button" id="to-map" class="map-btn" title="Select on map">üó∫Ô∏è</button>
                        </div>
                    </div>

                    <div class="via-input" style="display: none;">
                        <label for="via-input">Via (optional):</label>
                        <div class="location-field">
                            <input type="text" id="via-input" placeholder="Enter intermediate stop" class="location-text">
                            <button type="button" id="via-gps" class="gps-btn" title="Use current location">üìç</button>
                            <button type="button" id="via-map" class="map-btn" title="Select on map">üó∫Ô∏è</button>
                            <button type="button" id="remove-via" class="remove-btn" title="Remove via">‚úï</button>
                        </div>
                    </div>

                    <button type="button" id="add-via" class="btn btn-link">+ Add via stop</button>
                </div>

                <div class="trip-options">
                    <div class="time-options">
                        <label>
                            <input type="radio" name="timeType" value="depart" checked>
                            Depart at
                        </label>
                        <label>
                            <input type="radio" name="timeType" value="arrive">
                            Arrive by
                        </label>
                        <label>
                            <input type="radio" name="timeType" value="now">
                            Now
                        </label>
                    </div>

                    <div class="datetime-inputs">
                        <input type="date" id="trip-date" class="datetime-input">
                        <input type="time" id="trip-time" class="datetime-input">
                    </div>

                    <div class="transport-options">
                        <label>Transport types:</label>
                        <div class="transport-checkboxes">
                            <label><input type="checkbox" id="transport-bus" checked> üöå Bus</label>
                            <label><input type="checkbox" id="transport-tram" checked> üöã Tram</label>
                            <label><input type="checkbox" id="transport-trolley" checked> üöé Trolley</label>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üîç Find Routes</button>
                </div>
            </form>

            <!-- Results Section -->
            <div id="results" class="results" style="display: none;">
                <!-- Departures Results -->
                <div id="departures-results" class="departures-results">
                    <div class="station-info">
                        <h2 id="station-name"></h2>
                        <p id="last-updated"></p>
                        <div id="loading" class="loading" style="display: none;">
                            <span>üîÑ Updating...</span>
                        </div>
                        <div id="error" class="error" style="display: none;"></div>
                    </div>

                    <div class="departures-table">
                        <table id="departures">
                            <thead>
                                <tr>
                                    <th>Line</th>
                                    <th>ETA</th>
                                    <th>Stations</th>
                                    <th>Current Station</th>
                                    <th>Vehicle ID</th>
                                </tr>
                            </thead>
                            <tbody id="departures-body">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Navigation Results -->
                <div id="navigation-results" class="navigation-results" style="display: none;">
                    <div class="trip-info">
                        <h2 id="trip-summary"></h2>
                        <p id="trip-updated"></p>
                        <div id="nav-loading" class="loading" style="display: none;">
                            <span>üîÑ Finding routes...</span>
                        </div>
                        <div id="nav-error" class="error" style="display: none;"></div>
                    </div>

                    <div class="trips-container">
                        <div class="trips-header">
                            <h3>Route Options</h3>
                            <div class="sort-options">
                                <label>
                                    <input type="radio" name="sortTrips" value="time" checked>
                                    Fastest
                                </label>
                                <label>
                                    <input type="radio" name="sortTrips" value="changes">
                                    Fewest changes
                                </label>
                            </div>
                        </div>
                        <div id="trips-list" class="trips-list">
                        </div>
                    </div>
                </div>
    <button type="button" id="fab-find-routes" class="fab" title="Find routes">
        <span class="material-icons">search</span>
    </button>

                <div id="map" class="map"></div>
            </div>
        </main>

        <footer>
            <p>Powered by <a href="https://github.com/minicuby1234/bgpp" target="_blank">bgpp</a> and <a href="https://github.com/minicuby1234/transportr" target="_blank">Transportr</a></p>
        </footer>
    </div>

    <script src="static/js/config.js"></script>
    <script src="static/js/app.js"></script>
</body>
</html>
